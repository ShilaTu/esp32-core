# Makefiles

This is a collection of Makefiles that may be included for some default behavior.

## General Makefiles

### [help.mk](./help.mk)
- generates help text as default target
- help text is generated by adding targets & variables to dynamic variables
- variables
  - `TARGETS`
      - tracks targets that should appear in help text
  - `TARGETS_<name>`
      - tracks targets that should appear as a subtarget of `<name>`
  - `VARIABLES`
      - tracks groups of variables that should appear in help text
  - `VARIABLES_<name>`
      - tracks variables that should appear as part og the `<name>` group in help text
  - `HELP_<name>`
      - if `<name>` is in `TARGETS` or `VARIABLES` it is used as help text



### [common.mk](./common.mk)
- common behavior for all Makefiles
  - includes `help.mk`
  - should be used as base if new specific Makefile is added
- creates common targets
    - `all`
    - `build`
    - `test`
    - `check`
    - `setup`
    - `clean`
    - `distclean`
    - `docker`
      - starts docker container
      - onlt exists if `DOCKER_IMAGE` is specified
- variables
  - `DEPENDS`
    - array of directories
    - if common target is executed, make will execute the same target in these directories prior to executing it in the current Makefile   
  - `DOCKER_IMAGE`
    - default docker image to use if target should be executed in docker
  - `DOCKER_<name>`
    - custom docker image for the target `<name>`
  - `DOCKER`
    - tracks targets which should be executed inside the specified docker image
    - when one target is executed in docker, dependencies are also executed in docker if not specified otherwise
  - `NO_DOCKER`
    - tracks targets which shall not be executed inside docker

## Specific Makefiles

### [docker.mk](./docker.mk)

- common behavior for all docker images

### [idf.mk](./idf.mk)

- common behavior for all idf framework related projects

### [part.mk](./part.mk)

- common behaviour for all parts

### [product.mk](./product.mk)

- common behaviour for all products
